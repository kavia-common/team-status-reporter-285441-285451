{"is_source_file": true, "format": "JavaScript", "description": "This file defines a set of asynchronous functions for managing teams, members, roles, and permissions in a backend system. It interacts with a database using SQL queries to perform CRUD operations and access control checks related to team management.", "external_files": ["../db/pool"], "external_methods": ["pool.query", "pool.connect"], "published": ["listTeamsForUser", "createTeam", "getTeamById", "updateTeam", "archiveTeam", "listMembers", "addMember", "removeMember", "changeMemberRole", "listRoles", "assignRole", "revokeRole", "isTeamManagerOrAdmin"], "classes": [], "methods": [{"name": "isTeamManagerOrAdmin(userId, teamId)", "description": "Checks if a user is a manager or admin for a specific team or has global admin rights.", "scope": "", "scopeKind": ""}, {"name": "listTeamsForUser(user)", "description": "Retrieves a list of teams visible to a user; admins see all teams, members see their own.", "scope": "", "scopeKind": ""}, {"name": "createTeam({ name, description }, user)", "description": "Creates a new team and assigns the creator as a manager; only accessible to admins.", "scope": "", "scopeKind": ""}, {"name": "getTeamById(teamId, user)", "description": "Fetches team details by ID if the user has access (member or admin).", "scope": "", "scopeKind": ""}, {"name": "updateTeam(teamId, { name, description }, user)", "description": "Updates team information; requires user to be a manager or admin.", "scope": "", "scopeKind": ""}, {"name": "archiveTeam(teamId, user)", "description": "Soft deletes (archives) a team; requires admin or manager rights.", "scope": "", "scopeKind": ""}, {"name": "listMembers(teamId, user)", "description": "Lists all members of a team, accessible to team members and admins.", "scope": "", "scopeKind": ""}, {"name": "addMember(teamId, userId, role, actor)", "description": "Adds a new member to a team with specified role; requires management rights.", "scope": "", "scopeKind": ""}, {"name": "removeMember(teamId, userId, actor)", "description": "Removes (soft deletion) a member from a team; requires management rights.", "scope": "", "scopeKind": ""}, {"name": "changeMemberRole(teamId, userId, role, actor)", "description": "Modifies a member's role within a team; requires management rights.", "scope": "", "scopeKind": ""}, {"name": "listRoles()", "description": "Lists all available roles from the roles table.", "scope": "", "scopeKind": ""}, {"name": "assignRole(teamId, userId, roleName, actor)", "description": "Assigns a specific role to a user in a team or globally; restricted to admins or team managers.", "scope": "", "scopeKind": ""}, {"name": "revokeRole(assignmentId, actor)", "description": "Revokes a role assignment by ID; only admins or relevant team managers.", "scope": "", "scopeKind": ""}], "calls": ["pool.query", "pool.connect", "isTeamManagerOrAdmin"], "search-terms": ["teams management", "role assignments", "team members", "team creation", "team archival", "role revocation", "permission checks", "team listing", "member management"], "state": 2, "file_id": 24, "knowledge_revision": 89, "git_revision": "dc3555abc0c89d6beb88ae2923d75f22e107d114", "revision_history": [{"64": ""}, {"83": ""}, {"84": ""}, {"85": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}, {"87": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}, {"89": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}], "ctags": [{"_type": "tag", "name": "addMember", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function addMember(teamId, userId, role, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, role, actor)"}, {"_type": "tag", "name": "archiveTeam", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function archiveTeam(teamId, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, user)"}, {"_type": "tag", "name": "assignRole", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function assignRole(teamId, userId, roleName, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, roleName, actor)"}, {"_type": "tag", "name": "changeMemberRole", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function changeMemberRole(teamId, userId, role, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, role, actor)"}, {"_type": "tag", "name": "createTeam", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function createTeam({ name, description }, user) {$/", "language": "JavaScript", "kind": "function", "signature": "({ name, description }, user)"}, {"_type": "tag", "name": "getTeamById", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function getTeamById(teamId, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, user)"}, {"_type": "tag", "name": "isTeamManagerOrAdmin", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function isTeamManagerOrAdmin(userId, teamId) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId, teamId)"}, {"_type": "tag", "name": "listMembers", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function listMembers(teamId, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, user)"}, {"_type": "tag", "name": "listRoles", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function listRoles() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "listTeamsForUser", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^  listTeamsForUser,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "listTeamsForUser", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function listTeamsForUser(user) {$/", "language": "JavaScript", "kind": "function", "signature": "(user)"}, {"_type": "tag", "name": "pool", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^const pool = require('..\\/db\\/pool');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "removeMember", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function removeMember(teamId, userId, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, actor)"}, {"_type": "tag", "name": "revokeRole", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function revokeRole(assignmentId, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(assignmentId, actor)"}, {"_type": "tag", "name": "updateTeam", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function updateTeam(teamId, { name, description }, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, { name, description }, user)"}], "hash": "90af69deba39daf157ca4a10f456d259", "format-version": 4, "code-base-name": "express_backend", "filename": "express_backend/src/services/teams.js", "fields": [{"name": "listTeamsForUser,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}]}