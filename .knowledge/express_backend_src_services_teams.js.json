{"is_source_file": true, "format": "JavaScript", "description": "This file defines a set of asynchronous functions for managing teams, team members, roles, and role assignments in a backend service. It includes functionalities for creating, retrieving, updating, archiving teams, managing team members, and assigning/revoking roles, utilizing a database connection pool.", "external_files": ["../db/pool"], "external_methods": ["pool.query"], "published": ["listTeamsForUser", "createTeam", "getTeamById", "updateTeam", "archiveTeam", "listMembers", "addMember", "removeMember", "changeMemberRole", "listRoles", "assignRole", "revokeRole", "isTeamManagerOrAdmin"], "classes": [], "methods": [{"name": "isTeamManagerOrAdmin(userId, teamId)", "description": "Checks if a user has manager or admin role for a specific team, either directly via team_members or through role_assignments.", "scope": "", "scopeKind": ""}, {"name": "listTeamsForUser(user)", "description": "Returns a list of teams visible to a user; all teams if user is admin, otherwise only their teams.", "scope": "", "scopeKind": ""}, {"name": "createTeam({ name, description }, user)", "description": "Creates a new team; only accessible by administrators. The creator is added as the manager.", "scope": "", "scopeKind": ""}, {"name": "getTeamById(teamId, user)", "description": "Retrieves details of a team by ID if the user has access (member or admin).", "scope": "", "scopeKind": ""}, {"name": "updateTeam(teamId, { name, description }, user)", "description": "Updates the name and/or description of a team, accessible by managers or admins.", "scope": "", "scopeKind": ""}, {"name": "archiveTeam(teamId, user)", "description": "Soft deletes (archives) a team; only admins or team managers can perform this.", "scope": "", "scopeKind": ""}, {"name": "listMembers(teamId, user)", "description": "Lists members of a team; accessible to team members and admins.", "scope": "", "scopeKind": ""}, {"name": "addMember(teamId, userId, role, actor)", "description": "Adds a user to a team with a specified role; requires manager or admin privileges.", "scope": "", "scopeKind": ""}, {"name": "removeMember(teamId, userId, actor)", "description": "Removes (soft delete) a member from a team; requires manager or admin privileges.", "scope": "", "scopeKind": ""}, {"name": "changeMemberRole(teamId, userId, role, actor)", "description": "Changes a team member's role; requires manager or admin privileges.", "scope": "", "scopeKind": ""}, {"name": "listRoles()", "description": "Lists all available roles from the roles table.", "scope": "", "scopeKind": ""}, {"name": "assignRole(teamId, userId, roleName, actor)", "description": "Assigns a role to a user for a team, requiring admin or team manager privileges.", "scope": "", "scopeKind": ""}, {"name": "revokeRole(assignmentId, actor)", "description": "Revokes a role assignment by setting its revoked_at timestamp; requires admin or team manager privileges.", "scope": "", "scopeKind": ""}], "calls": ["pool.query", "pool.connect", "pool.release"], "search-terms": ["team_management", "role_assignment", "team_members", "team_roles", "role_management"], "state": 2, "file_id": 24, "knowledge_revision": 105, "git_revision": "dc3555abc0c89d6beb88ae2923d75f22e107d114", "revision_history": [{"64": ""}, {"83": ""}, {"84": ""}, {"85": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}, {"87": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}, {"89": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}, {"101": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}, {"102": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}, {"104": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}, {"105": "dc3555abc0c89d6beb88ae2923d75f22e107d114"}], "ctags": [{"_type": "tag", "name": "addMember", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function addMember(teamId, userId, role, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, role, actor)"}, {"_type": "tag", "name": "archiveTeam", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function archiveTeam(teamId, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, user)"}, {"_type": "tag", "name": "assignRole", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function assignRole(teamId, userId, roleName, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, roleName, actor)"}, {"_type": "tag", "name": "changeMemberRole", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function changeMemberRole(teamId, userId, role, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, role, actor)"}, {"_type": "tag", "name": "createTeam", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function createTeam({ name, description }, user) {$/", "language": "JavaScript", "kind": "function", "signature": "({ name, description }, user)"}, {"_type": "tag", "name": "getTeamById", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function getTeamById(teamId, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, user)"}, {"_type": "tag", "name": "isTeamManagerOrAdmin", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function isTeamManagerOrAdmin(userId, teamId) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId, teamId)"}, {"_type": "tag", "name": "listMembers", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function listMembers(teamId, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, user)"}, {"_type": "tag", "name": "listRoles", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function listRoles() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "listTeamsForUser", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^  listTeamsForUser,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "listTeamsForUser", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function listTeamsForUser(user) {$/", "language": "JavaScript", "kind": "function", "signature": "(user)"}, {"_type": "tag", "name": "pool", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^const pool = require('..\\/db\\/pool');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "removeMember", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function removeMember(teamId, userId, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, actor)"}, {"_type": "tag", "name": "revokeRole", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function revokeRole(assignmentId, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(assignmentId, actor)"}, {"_type": "tag", "name": "updateTeam", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function updateTeam(teamId, { name, description }, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, { name, description }, user)"}], "hash": "ee745921ee1a63bda293029f7ccaa946", "format-version": 4, "code-base-name": "express_backend", "filename": "express_backend/src/services/teams.js", "fields": [{"name": "listTeamsForUser,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}]}