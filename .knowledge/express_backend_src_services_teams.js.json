{"is_source_file": true, "format": "JavaScript", "description": "This file defines the team management service logic, including functions for managing teams, members, roles, and access control within a project. It interacts with a database via a pool and includes helper functions for authorization and role handling.", "external_files": ["../db/pool"], "external_methods": ["pool.query"], "published": ["listTeamsForUser", "createTeam", "getTeamById", "updateTeam", "archiveTeam", "listMembers", "addMember", "removeMember", "changeMemberRole", "listRoles", "assignRole", "revokeRole", "isTeamManagerOrAdmin"], "classes": [], "methods": [{"name": "isTeamManagerOrAdmin(userId, teamId)", "description": "Checks if a user is a manager or admin for a specific team or globally.", "scope": "", "scopeKind": ""}, {"name": "listTeamsForUser(user)", "description": "Returns a list of teams visible to the user, either all for admins or specific ones for members.", "scope": "", "scopeKind": ""}, {"name": "createTeam({ name, description }, user)", "description": "Creates a new team; only accessible by admin users. The creator becomes the team manager.", "scope": "", "scopeKind": ""}, {"name": "getTeamById(teamId, user)", "description": "Retrieves a team's details if the user has access.", "scope": "", "scopeKind": ""}, {"name": "updateTeam(teamId, { name, description }, user)", "description": "Updates team details; only accessible by team managers or admins.", "scope": "", "scopeKind": ""}, {"name": "archiveTeam(teamId, user)", "description": "Soft deletes (archives) a team; only accessible by team managers or admins.", "scope": "", "scopeKind": ""}, {"name": "listMembers(teamId, user)", "description": "Lists team members; accessible by members and admins.", "scope": "", "scopeKind": ""}, {"name": "addMember(teamId, userId, role, actor)", "description": "Adds a member to a team with a specified role, requires managerial or admin privileges.", "scope": "", "scopeKind": ""}, {"name": "removeMember(teamId, userId, actor)", "description": "Removes (soft delete) a member from a team, requiring privileges.", "scope": "", "scopeKind": ""}, {"name": "changeMemberRole(teamId, userId, role, actor)", "description": "Changes a member's role within a team, requiring managerial privileges.", "scope": "", "scopeKind": ""}, {"name": "listRoles()", "description": "Lists available roles from the roles table.", "scope": "", "scopeKind": ""}, {"name": "assignRole(teamId, userId, roleName, actor)", "description": "Assigns a specific role to a user for a team; only managers or admins can do so.", "scope": "", "scopeKind": ""}, {"name": "revokeRole(assignmentId, actor)", "description": "Revokes a role assignment by its ID; accessible by admins or team managers.", "scope": "", "scopeKind": ""}], "calls": ["pool.query", "client.query", "pool.connect"], "search-terms": ["team management", "role assignments", "team members", "authorization", "team creation", "archive team", "list team members", "role management", "user roles"], "state": 2, "file_id": 24, "knowledge_revision": 84, "git_revision": "", "revision_history": [{"64": ""}, {"83": ""}, {"84": ""}], "ctags": [{"_type": "tag", "name": "addMember", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function addMember(teamId, userId, role, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, role, actor)"}, {"_type": "tag", "name": "archiveTeam", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function archiveTeam(teamId, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, user)"}, {"_type": "tag", "name": "assignRole", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function assignRole(teamId, userId, roleName, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, roleName, actor)"}, {"_type": "tag", "name": "changeMemberRole", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function changeMemberRole(teamId, userId, role, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, role, actor)"}, {"_type": "tag", "name": "createTeam", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function createTeam({ name, description }, user) {$/", "language": "JavaScript", "kind": "function", "signature": "({ name, description }, user)"}, {"_type": "tag", "name": "getTeamById", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function getTeamById(teamId, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, user)"}, {"_type": "tag", "name": "isTeamManagerOrAdmin", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function isTeamManagerOrAdmin(userId, teamId) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId, teamId)"}, {"_type": "tag", "name": "listMembers", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function listMembers(teamId, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, user)"}, {"_type": "tag", "name": "listRoles", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function listRoles() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "listTeamsForUser", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^  listTeamsForUser,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "listTeamsForUser", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function listTeamsForUser(user) {$/", "language": "JavaScript", "kind": "function", "signature": "(user)"}, {"_type": "tag", "name": "pool", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^const pool = require('..\\/db\\/pool');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "removeMember", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function removeMember(teamId, userId, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, userId, actor)"}, {"_type": "tag", "name": "revokeRole", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function revokeRole(assignmentId, actor) {$/", "language": "JavaScript", "kind": "function", "signature": "(assignmentId, actor)"}, {"_type": "tag", "name": "updateTeam", "path": "/home/kavia/workspace/code-generation/team-status-reporter-285441-285451/express_backend/src/services/teams.js", "pattern": "/^async function updateTeam(teamId, { name, description }, user) {$/", "language": "JavaScript", "kind": "function", "signature": "(teamId, { name, description }, user)"}], "hash": "f29ac992827e809f64ca8d4a17c778c6", "format-version": 4, "code-base-name": "express_backend", "filename": "express_backend/src/services/teams.js", "fields": [{"name": "listTeamsForUser,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}]}